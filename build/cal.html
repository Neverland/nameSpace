<!DOCTYPE html		PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"		"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>	<title></title>	<style type="text/css">		* {			padding: 0;			margin: 0;		}		body {			font-size: 14px;		}		table {			border-collapse: collapse;			border: none;		}		th { background: #eee; }		th,td {			border: 1px #ccc solid;			padding: 5px;			text-align: center;		}		.calContainer {			margin: 0 10px 10px 0;		}		.currentDay {			background: red;		}		#cal {			border: 2px solid red;			overflow: hidden;			height: 92%;			padding: 10px;			margin: 10px;		}		#cal div ,#cals .calContainer {			float: left;			margin: 0 3px 10px 0;			height: 210px;		}		input {			width: 30px;		}		.oldDay {			color: #ccc;			font-size: 14px;		}		#cals td ,#cals th {padding: 11px;}	</style></head><body><h1>2012年台历</h1><div id="cal"></div><div id="cals"></div><button id="_4"> 显示第4个例子</button><script type="text/javascript">/* * Copyright 2012 enix * enix@foxmail.com * Includes toolkit lib * Date: 2012-6-29 */function Cal(P, O) {	if (!P || !P.nodeType) {		return	}	var indicotar = arguments.callee,			Pb, Pr, that = this,			tk, doc, X;	if (!(this instanceof indicotar)) {		return that = new indicotar(P, O)	}	Pb = indicotar.prototype;	Pb.constructor = indicotar;	Pr = {		meta:{			year:'\u5e74',			season:'\u5b63',			season2:'\u5b63\u5EA6',			month:'\u6708',			week:['\u65e5', '\u4e00', '\u4e8c', '\u4e09', '\u56db', '\u4e94', '\u516d'],			week2:'\u5468',			day:'\u65e5',			sel:'\u9009\u62e9',			cur:'\u672c',			prev:'\u4e0a',			next:'\u4e0b',			all:'\u5168',			today:'\u4eca'		},		dayTime:86400000,		util:function () {			Object.keys || (Object.keys = function (o) {				var t = [];				for (t[t.length] in o) {				}				return t			})		}	};	Pb.toolKit || (Pb.toolKit = function () {		var S = arguments.callee;		S.prototype = {			is:function (o) {				return ({}).toString.call(o).slice(8, -1)			},			each:function (object, callback) {				var index, i = 0,						len = object.length >>> 0,						isO = ({}).toString.call(object).slice(8, -1) === 'Object';				if (isO) {					for (index in object) {						if (callback.call(object[index], object[index], index) === false) {							break						}					}				} else {					for (; i < len;) {						if (callback.call(object[i], object[i], i++) === false) {							break						}					}				}			},			getHtmlElement:function (O) {				var that = this;				that.element || (that.element = {});				that.element[O] || (that.element[O] = doc.createElement(O));				return that.element[O].cloneNode(true)			},			getEvent:function (e) {				return e || window.event			},			getTarget:function (e) {				return e.srcElement || e.target			},			addEvent:function (elem, evType, fn, capture) {				var indicator = arguments.callee;				elem && elem.attachEvent && (indicator = function (elem, evType, fn) {					elem.attachEvent('on' + evType, fn)				}).apply(this, arguments);				elem && elem.addEventListener && (indicator = function (elem, evType, fn) {					elem.addEventListener(evType, fn, capture || false)				}).apply(this, arguments);				elem && elem['on' + evType] && (indicator = function (elem, evType, fn) {					elem['on' + evType] = function () {						fn()					}				}).apply(this, arguments)			},			trigger:function (elem, evType) {				var event;				undefined !== doc.createEvent ? (event = doc.createEvent('MouseEvents'), event.initMouseEvent(evType, true, true, doc.defaultView, 0, 0, 0, 0, 0, false, false, false, false, 0, null), elem.dispatchEvent(event)) : (event = doc.createEventObject(), event.screenX = 100, event.screenY = 0, event.clientX = 0, event.clientY = 0, event.ctrlKey = false, event.altKey = false, event.shiftKey = false, event.button = false, elem.fireEvent('on' + evType, event))			}		};		if (window == this) {			return new S		}	}());	Pb.init = function () {		doc = document || ownerDocument;		tk || (tk = Pb.toolKit);		indicotar.cache || (indicotar.cache = {});		that._OP_ = P;		that.Date = new Date;		O = O || ({});		that.frame = doc.createDocumentFragment();		that.endYear = O.EndYear || that.Date.getFullYear() + 10;		that.startYear = !isNaN(O.startYear) ? O.startYear : 2006;		that.Year = that.Date.getFullYear();		that.Month = that.Date.getMonth();		that.Day = that.Date.getDate();		that.startYear = Math.max(1970, that.startYear);		that.startYear = Math.min(that.startYear, that.Year);		that.time = +that.Date;		that.style = O.style || '-';		O && (tk.each(O, function (a, b) {			that[b] || (that[b] = a)		}));		if (that.Y) {			//that.Y = Math.max(that.startYear, that.Y);			//that.Y = Math.min(that.endYear, that.Y);			if (that.M) {				that.M = Math.abs(that.M) - 1			}			//that.M = isNaN(that.M) ? that.Month : that.M;			//that.M = Math.max(that.M, 0);			//that.M = Math.min(that.M, 11)		}		that.hasTitle = O.hasTitle || 'true';		that.hasFoot = that.hasFoot || 'false';		'function' == typeof O.fn && (that.fn = O.fn);		that.createProperty().controlsFactory().createCalFrame().createTableTitle().createYear().createMonth();		that.addEvent();		return that	};	Pb.createProperty = function () {		return that.elems = [			['div', 'class#calContainer'],//0			['div', 'class#calHeader'],//1			['div', 'class#calBody'],//2			['select', 'class#selectYear'],//3			['select', 'class#selectMonth'],//4			['input', 'type#button,class#calPrev,value#<'],//5			['input', 'type#button,class#calNext,value#>'],//6			['input', 'type#button,class#calPrevPro,value#«'],//7			['input', 'type#button,class#calNextPro,value#»'],//8			//['table', 'class#calBox'],//9			//['thead'],//10			//['tbody'],//11			//['tfoot'],//12			['input', 'type#button,class#calToday,value#' + Pr.meta.today]//13		], that	};	Pb.controlsFactory = function () {		var t, attr;		tk.each(that.elems, function (a, b) {			t = tk.getHtmlElement(a[0]);			a[1] && tk.each(a[1].split(','), function (x, y) {				attr = (attr = x.split('#'), attr[0] && t.setAttribute(attr[0], attr[1]))			});			that.elems.splice(b, 1, t)		});		return that	};	Pb.createCalFrame = function () {		var t = doc.createDocumentFragment(),				e = that.elems,				meta = Pr.meta,				w = Pr.meta.week,				len = w.length,				tHtml = [];		e[1].appendChild(e[7]);		e[1].appendChild(e[5]);		e[1].appendChild(e[3]);		e[1].appendChild(doc.createTextNode(meta.year));		e[1].appendChild(e[4]);		e[1].appendChild(doc.createTextNode(meta.month));		//e[2].appendChild(e[9]);		e[1].appendChild(e[6]);		e[1].appendChild(e[8]);		e[1].appendChild(e[9]);		'true' === that.hasTitle && (e[0].appendChild(e[1]));		e[0].appendChild(e[2]);		that.frame.appendChild(e[0]);		'function' === that.oncalframe && that.oncalframe();		return that	};	Pb.addEvent = function () {		var elems = that.elems,				nodes = [					[elems[3], 'change', function (e) {						e = tk.getEvent(e);						var target = tk.getTarget(e);						that.createDay(target.value, elems[4].value)					}],					[elems[4], 'change', function (e) {						e = tk.getEvent(e);						var target = tk.getTarget(e);						that.createDay(elems[3].value, target.value)					}],					[elems[6], 'click', function (e) {						var m = elems[4],								index = m.selectedIndex,								i, y = elems[3];						if (index + 1 <= 11) {							i = index + 1						} else {							if (y.value == that.endYear) {								y.options[y.length - 1].selected = ' ';								m.value = 0;								that.createDay(y.value, m.value);								return							}							i = 0;							y.selectedIndex = y.selectedIndex - 1						}						m.value = i;						m.selectedIndex = i;						y.value && that.createDay(y.value, m.value)					}],					[elems[5], 'click', function () {						var m = elems[4],								index = m.selectedIndex,								i, y = elems[3];						if (index - 1 >= 0) {							i = index - 1						} else {							if (y.value == that.startYear) {								y.selectedIndex = y.length							}							i = 11;							y.selectedIndex = y.selectedIndex + 1						}						m.value = i;						m.selectedIndex = i;						y.value && that.createDay(y.value, m.value)					}],					[elems[7], 'click', function () {						var y = +elems[3].value,								m = elems[4].value;						if (y-- <= that.startYear) {							return						}						elems[3].selectedIndex = y;						elems[3].value = y;						that.createDay(y, m)					}],					[elems[8], 'click', function () {						var y = +elems[3].value,								m = elems[4].value;						if (y++ >= that.endYear) {							return						}						elems[3].selectedIndex = y;						elems[3].value = y;						that.createDay(y, m)					}],					[elems[9], 'click', function () {						elems[3].selectedIndex = that.Year;						elems[3].value = that.Year;						elems[4].selectedIndex = that.Month;						elems[4].value = that.Month;						that.createDay(that.Year, that.Month)					}],					[elems[2], 'click', function (e) {						e = tk.getEvent(e);						var target = tk.getTarget(e),								val;						if (!/tr|tbody|thead|table/.test(target.nodeName.toLowerCase())) {							while (target.nodeName.toLowerCase() !== 'td') {								target = target.parentNode							}							val = target.innerHTML						}						!/thead|tfoot/.test(target.parentNode.parentNode.nodeName.toLocaleLowerCase())  && val && that.getDateValue(val);						return that					}]				], i = nodes.length;		while (i--) {			(function (t) {				tk.addEvent(t[0], t[1], function (e) {					'function' === typeof t[2] && t[2](e)				}, false)			})(nodes[i])		}		if (that.Y) {			tk.each(elems[3], function (a, b) {				elems.selectedIndex = b			});			elems[3].value = that.Y;			elems[4].selectedIndex = that.M;			that.createDay(that.Y, that.M)		} else {			tk.trigger(that.elems[9], 'click')		}		return that	};	Pb.getDateValue = function (val) {		var date = [], elems = this.elems;		date.push(+this.elems[3].value || this.Year);		date.push(+this.elems[4].value + 1 || this.Month);		date.push(+val || this.Day);		this.selectDate = date;		'function' === typeof this.ongetdate && this.ongetdate.call(this, date);		this.fn && this.fn();		return this	};	//TODO: update	Pb.update = function () {	};	Pb.createTableTitle = function () {		var w = Pr.meta.week,				len = w.length,				html = [];		while (len--) {			html.push('<th title="'+w[len]+'">' + w[len] + '</th>')		}		that.title = '<thead>' + html.reverse().join('') + '</thead>';		return that	};	Pb.createYear = function () {		var t = [],				y, num;		y = that.endYear - that.startYear + 1;		while (y--) {			num = that.endYear - y;			that.elems[3].options[y] = new Option(num, num, num === that.Year)		}		return that	};	Pb.createMonth = function () {		var t = [],				m = 12;		while (m--) {			that.elems[4].options[m] = new Option(m + 1, m, m === that.Month)		}		return that	};	Pb.getMaxDays = function (year, month) {		var t = +month + 1;		month = t > 12 ? 1 : t;		year = t > 12 ? (+year + 1) : year;		return (new Date(+(new Date(year, month, 1)) - Pr.dayTime)).getDate()	};	Pb.getFirstDay = function (year, month) {		return new Date(year, month, 1).getDay()	};	Pb.createDay = function (Y, M) {		var that=this;		Y = +Y;		M = +M;		Y = Math.max(that.startYear, Y);		Y = Math.min(that.endYear, Y);		M = isNaN(M) ? that.Month : M;		M = Math.max(M, 0);		M = Math.min(M, 11)		var key = '_date_:' + Y + ':' + M,				elems = that.elems;		indicotar.cache[key] || (indicotar.cache[key] = that.getDateString(Y, M));		that.render(elems, key, Y, M);		return that	};	Pb.getDateString = function (y, m) {		var     that=this,				days = that.getMaxDays(y, m),				first = that.getFirstDay(y, m),				offset = days + first,				html = [],				row = Math.ceil(offset / 7),				cell = row * 7;		for (var i = 0; i < row; i++) {			html.push('</tr>');			for (var j = 0; j < 7; j++) {				html.push((cell-- <= offset && days > 0) ? ('<td ' + (that.Date > new Date(y, m, days + 1) ? 'class="oldDay"' : '') + (y === that.Year && m === that.Month && days === that.Day ? 'class="currentDay"' : '') + ' title="'+y+that.style+(m+1)+that.style+days+'">' + (days--) + '</td>') : '<td></td>');			}			html.push('<tr>')		}		html=html.reverse().join('');		('function'===typeof that.ongetdatestring) && that.ongetdatestring.call(that,html);		return html;	};	Pb.toString = function () {		return this.selectDate.join(this.style)	};	Pb.valueOf = function () {		return this.selectDate	};	Pb.render = function (elems, key, y, m) {		var     that=this,				meta = Pr.meta,				tfoot;		if ('true' === that.hasFoot) {			tfoot = '<tfoot><tr><td colspan="7">' + y + meta.year + (m + 1) + meta.month + '</td></tr></tfoot>'			//tfoot = '<caption>'+ y + meta.year + (m + 1) + meta.month +'</caption>';		}		elems[2].innerHTML = '<table cellpadding="5" border="1" cellspacing="0">' + that.title + indicotar.cache[key] + ('true' === that.hasFoot ? tfoot : '') + '</table>';		that._OP_.appendChild(that.frame);		('function'===typeof that.onrender) && that.onrender.call(that,that.frame);	};	Pb.setCss = function (O) {		var value = [];		tk.is(O) === 'object' && (tk.each(O, function (a, b) {			value.push(b + ':' + a)		}));		this.elems[0].style.cssText = value.join(';')	};	Pb.show = function () {		this.elems[0].style.display = 'block'		return this	};	Pb.hide = function () {		this.elems[0].style.display = 'none'		return this	};	return that.init(), this;}(function () {	var i = 12, p = document.getElementById('cal'), ts = document.getElementById('cals'), _;	//demo 1	Cal(ts, {a:1, b:2, ongetdate:function () {		var data=arguments[0]		alert(data[0]+'年'+data[1]+'月'+data[2]+'日');	}});	//demo 2	Cal(ts, {a:5, b:6, Y:2015, M:12, ongetdate:function () {		alert(this.toString());	}, startYear:2000});	//demo 4	_ = Cal(ts).hide();	document.getElementById('_4').onclick = function () {		this.disabled='ture';		_.show();	}	//demo 3	for (; i--;) {		//console.log(12-i);		Cal(p, {Y:2012, M:12 - i, hasTitle:'false', hasFoot:'true', ongetdate:function () {			alert(this.toString());			//this.hide();		},style:'/'});	}})()</script></body></html>